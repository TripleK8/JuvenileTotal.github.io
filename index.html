<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard ข้อมูลกลุ่มตัวอย่าง</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>

    <script>
        tailwind.config = {
            theme: {
                fontFamily: {
                    sans: ['Sarabun', 'sans-serif'],
                },
                extend: {
                    colors: {
                        primary: '#4F46E5',
                        secondary: '#10B981',
                        accent: '#F59E0B',
                    },
                    boxShadow: {
                        'soft': '0 4px 20px -2px rgba(0, 0, 0, 0.05)',
                        'card': '0 0 0 1px rgba(0,0,0,0.03), 0 2px 8px rgba(0,0,0,0.04)',
                    }
                }
            }
        }
    </script>
    <style>
        .animate-fade-in-up {
            animation: fadeInUp 0.6s ease-out forwards;
            opacity: 0;
            transform: translateY(20px);
        }
        @keyframes fadeInUp {
            to { opacity: 1; transform: translateY(0); }
        }
        .delay-100 { animation-delay: 0.1s; }
        .delay-200 { animation-delay: 0.2s; }
        .delay-300 { animation-delay: 0.3s; }
    </style>
</head>
<body class="bg-gray-50 min-h-screen font-sans text-slate-600">

    <!-- Navbar / Header (ปรับแก้: ลบ sticky top-0 ออกเพื่อให้ไม่ลอย) -->
    <nav class="bg-white border-b border-gray-100">
        <div class="container mx-auto max-w-7xl px-6 py-4 flex justify-between items-center">
            <div class="flex items-center gap-3">
                <div class="p-2 bg-indigo-50 rounded-lg text-indigo-600">
                    <i data-lucide="layout-dashboard"></i>
                </div>
                <div>
                    <h1 class="text-xl font-bold text-slate-800 leading-tight">Dashboard กลุ่มตัวอย่าง</h1>
                    <p class="text-xs text-slate-500">ติดตามสถานะการวิจัยและลงพื้นที่</p>
                </div>
            </div>
            <button onclick="window.print()" class="hidden md:flex items-center gap-2 text-sm font-medium text-slate-500 hover:text-indigo-600 transition-colors bg-gray-50 hover:bg-indigo-50 px-4 py-2 rounded-lg border border-transparent hover:border-indigo-100 cursor-pointer">
                <i data-lucide="printer" size="16"></i> พิมพ์รายงาน
            </button>
        </div>
    </nav>

    <main class="container mx-auto max-w-7xl px-6 py-8 space-y-8">
        
        <!-- Summary Cards -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 animate-fade-in-up">
            <!-- Card 1 -->
            <div class="bg-white p-6 rounded-2xl shadow-card hover:shadow-lg transition-shadow duration-300 relative overflow-hidden group">
                <div class="absolute right-0 top-0 h-full w-1/3 bg-gradient-to-l from-blue-50 to-transparent opacity-50 group-hover:from-blue-100 transition-all"></div>
                <div class="relative z-10">
                    <div class="flex items-center gap-3 mb-4">
                        <div class="p-2.5 rounded-xl bg-blue-100 text-blue-600 shadow-sm">
                            <i data-lucide="users" size="20"></i>
                        </div>
                        <h3 class="text-sm font-semibold text-slate-500 uppercase tracking-wide">กลุ่มตัวอย่างทั้งหมด</h3>
                    </div>
                    <div class="flex items-baseline gap-2">
                        <span id="totalSamples" class="text-4xl font-bold text-slate-800 tracking-tight">0</span>
                        <span class="text-sm font-medium text-slate-400">คน</span>
                    </div>
                    <div class="mt-2 text-xs text-green-600 bg-green-50 inline-block px-2 py-0.5 rounded-full font-medium">
                        <i data-lucide="check-circle" size="12" class="inline mr-1"></i> เก็บข้อมูลครบถ้วน
                    </div>
                </div>
            </div>

            <!-- Card 2 -->
            <div class="bg-white p-6 rounded-2xl shadow-card hover:shadow-lg transition-shadow duration-300 relative overflow-hidden group">
                <div class="absolute right-0 top-0 h-full w-1/3 bg-gradient-to-l from-indigo-50 to-transparent opacity-50 group-hover:from-indigo-100 transition-all"></div>
                <div class="relative z-10">
                    <div class="flex items-center gap-3 mb-4">
                        <div class="p-2.5 rounded-xl bg-indigo-100 text-indigo-600 shadow-sm">
                            <i data-lucide="user" size="20"></i>
                        </div>
                        <h3 class="text-sm font-semibold text-slate-500 uppercase tracking-wide">สัดส่วนเพศชาย</h3>
                    </div>
                    <div class="flex items-baseline gap-2">
                        <span id="maleCount" class="text-4xl font-bold text-slate-800 tracking-tight">0</span>
                        <span class="text-sm font-medium text-slate-400">คน</span>
                    </div>
                    <div class="mt-2 text-sm text-indigo-600 font-medium">
                        คิดเป็น <span id="malePercent">0%</span> ของทั้งหมด
                    </div>
                </div>
            </div>

            <!-- Card 3 -->
            <div class="bg-white p-6 rounded-2xl shadow-card hover:shadow-lg transition-shadow duration-300 relative overflow-hidden group">
                <div class="absolute right-0 top-0 h-full w-1/3 bg-gradient-to-l from-emerald-50 to-transparent opacity-50 group-hover:from-emerald-100 transition-all"></div>
                <div class="relative z-10">
                    <div class="flex items-center gap-3 mb-4">
                        <div class="p-2.5 rounded-xl bg-emerald-100 text-emerald-600 shadow-sm">
                            <i data-lucide="map-pin" size="20"></i>
                        </div>
                        <h3 class="text-sm font-semibold text-slate-500 uppercase tracking-wide">ศูนย์ฝึกฯ ที่เข้าร่วม</h3>
                    </div>
                    <div class="flex items-baseline gap-2">
                        <span id="centerCount" class="text-4xl font-bold text-slate-800 tracking-tight">0</span>
                        <span class="text-sm font-medium text-slate-400">แห่ง</span>
                    </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Charts Section -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 animate-fade-in-up delay-100">
            <div class="bg-white p-6 rounded-2xl shadow-soft border border-gray-100">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-lg font-bold text-slate-800">การกระจายตัวของเพศ</h2>
                    <button class="text-slate-400 hover:text-indigo-600 cursor-pointer"><i data-lucide="more-horizontal"></i></button>
                </div>
                <div class="relative h-[300px]">
                    <canvas id="genderChart"></canvas>
                </div>
            </div>

            <div class="bg-white p-6 rounded-2xl shadow-soft border border-gray-100">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-lg font-bold text-slate-800">สัดส่วนตามศูนย์ฝึกฯ</h2>
                    <button class="text-slate-400 hover:text-indigo-600 cursor-pointer"><i data-lucide="pie-chart"></i></button>
                </div>
                <div class="relative h-[300px] flex justify-center">
                    <canvas id="pieChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Table Section -->
        <div class="bg-white rounded-2xl shadow-soft border border-gray-100 overflow-hidden animate-fade-in-up delay-200">
            <div class="p-6 border-b border-gray-100 flex flex-col md:flex-row md:items-center justify-between gap-4">
                <div>
                    <h2 class="text-xl font-bold text-slate-800 flex items-center gap-2">
                        <i data-lucide="calendar-days" class="text-indigo-500"></i>
                        ตารางกำหนดการลงพื้นที่
                    </h2>
                    <p class="text-sm text-slate-500 mt-1">รายละเอียดจำนวนกลุ่มตัวอย่างและช่วงเวลาดำเนินการ</p>
                </div>
                <div class="flex gap-2">
                    <span class="px-3 py-1 bg-indigo-50 text-indigo-700 rounded-lg text-xs font-semibold uppercase tracking-wider">Year 2025-2026</span>
                </div>
            </div>
            
            <div class="overflow-x-auto">
                <table class="w-full text-sm text-left">
                    <thead class="bg-gray-50 text-slate-500 font-semibold text-xs uppercase tracking-wider">
                        <tr>
                            <th class="px-6 py-4 rounded-tl-lg">#</th>
                            <th class="px-6 py-4">ศูนย์ฝึกและอบรมฯ</th>
                            <th class="px-6 py-4">ช่วงเวลาดำเนินการ</th>
                            <th class="px-6 py-4 text-center">ชาย</th>
                            <th class="px-6 py-4 text-center">หญิง</th>
                            <th class="px-6 py-4 text-right rounded-tr-lg">รวม (คน)</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody" class="divide-y divide-gray-100">
                        <!-- JS renders here -->
                    </tbody>
                    <tfoot class="bg-gray-50/50 font-bold text-slate-800">
                        <tr>
                            <td colspan="3" class="px-6 py-5 text-right text-slate-500">รวมทั้งหมด</td>
                            <td id="totalMaleTable" class="px-6 py-5 text-center text-indigo-600">0</td>
                            <td id="totalFemaleTable" class="px-6 py-5 text-center text-pink-600">0</td>
                            <td id="totalSampleTable" class="px-6 py-5 text-right text-lg">0</td>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>

    </main>

    <footer class="container mx-auto max-w-7xl px-6 py-8 text-center text-slate-400 text-sm">
        &copy; 2025 Research Dashboard System. All rights reserved.
    </footer>

    <script>
        // ข้อมูลหลัก (Stats)
        const data1 = [
            { center: "ระยอง", sample: 18, male: 14, female: 4 },
            { center: "บ้านชายกรุณา", sample: 47, male: 47, female: 0 },
            { center: "ราชบุรี", sample: 41, male: 40, female: 1 },
            { center: "เชียงใหม่", sample: 60, male: 56, female: 4 },
            { center: "สุราษฎร์ธานี", sample: 66, male: 60, female: 6 },
            { center: "อุบลราชธานี", sample: 140, male: 131, female: 9 },
        ];

        // ข้อมูลรายละเอียด + วันที่
        const data2 = [
            { name: "ศูนย์ฝึกและอบรมเด็กและเยาวชนระยอง", province: "ระยอง", date: "17 – 22 พ.ย. 68" },
            { name: "ศูนย์ฝึกและอบรมเด็กและเยาวชนบ้านชายกรุณา", province: "สมุทรปราการ", date: "8 – 13 ธ.ค. 68" },
            { name: "ศูนย์ฝึกและอบรมเด็กและเยาวชนราชบุรี", province: "ราชบุรี", date: "15 – 20 ธ.ค. 68" },
            { name: "ศูนย์ฝึกและอบรมเด็กและเยาวชนเชียงใหม่", province: "เชียงใหม่", date: "5 – 10 ม.ค. 69" },
            { name: "ศูนย์ฝึกและอบรมเด็กและเยาวชนสุราษฎร์ธานี", province: "สุราษฎร์ธานี", date: "19 – 24 ม.ค. 69" },
            { name: "ศูนย์ฝึกและอบรมเด็กและเยาวชนอุบลราชธานี", province: "อุบลราชธานี", date: "2 – 7, 9 – 14 ก.พ. 69" },
        ];

        // คำนวณยอดรวม
        const totalStats = data1.reduce((acc, curr) => ({
            sample: acc.sample + curr.sample,
            male: acc.male + curr.male,
            female: acc.female + curr.female
        }), { sample: 0, male: 0, female: 0 });

        // Update UI with animation count up effect (Simulated)
        document.getElementById('totalSamples').innerText = totalStats.sample;
        document.getElementById('maleCount').innerText = totalStats.male;
        document.getElementById('malePercent').innerText = ((totalStats.male / totalStats.sample) * 100).toFixed(1) + "%";
        document.getElementById('centerCount').innerText = data1.length;

        // Footer Table
        document.getElementById('totalMaleTable').innerText = totalStats.male;
        document.getElementById('totalFemaleTable').innerText = totalStats.female;
        document.getElementById('totalSampleTable').innerText = totalStats.sample;

        // Render Table
        const tableBody = document.getElementById('tableBody');
        data1.forEach((row, index) => {
            let info = data2.find(d => d.province === row.center);
            if (!info && row.center === "บ้านชายกรุณา") {
                info = data2.find(d => d.province === "สมุทรปราการ");
            }

            const tr = document.createElement('tr');
            tr.className = "hover:bg-indigo-50/40 transition-colors group cursor-default";
            tr.innerHTML = `
                <td class="px-6 py-4 text-slate-400 font-mono text-xs">${String(index + 1).padStart(2, '0')}</td>
                <td class="px-6 py-4">
                    <div class="font-bold text-slate-700 group-hover:text-indigo-700 transition-colors">${info ? info.name : row.center}</div>
                    <div class="flex items-center gap-1 text-xs text-slate-400 mt-0.5">
                        <i data-lucide="map-pin" size="10"></i> ${info ? info.province : ''}
                    </div>
                </td>
                <td class="px-6 py-4">
                    <span class="inline-flex items-center px-3 py-1 rounded-md text-xs font-medium bg-white border border-slate-200 text-slate-600 shadow-sm group-hover:border-indigo-200 group-hover:text-indigo-600 transition-all">
                        <i data-lucide="calendar" size="12" class="mr-1.5 opacity-70"></i>
                        ${info ? info.date : '-'}
                    </span>
                </td>
                <td class="px-6 py-4 text-center">
                    <span class="inline-block w-8 py-1 rounded bg-indigo-50 text-indigo-700 font-bold text-xs">${row.male}</span>
                </td>
                <td class="px-6 py-4 text-center">
                    <span class="inline-block w-8 py-1 rounded bg-pink-50 text-pink-700 font-bold text-xs">${row.female}</span>
                </td>
                <td class="px-6 py-4 text-right">
                    <span class="font-bold text-slate-800 text-base">${row.sample}</span>
                </td>
            `;
            tableBody.appendChild(tr);
        });

        // Charts Configuration
        Chart.defaults.font.family = "'Sarabun', sans-serif";
        Chart.defaults.color = '#64748b';

        const ctxGender = document.getElementById('genderChart').getContext('2d');
        new Chart(ctxGender, {
            type: 'bar',
            data: {
                labels: data1.map(d => d.center),
                datasets: [
                    { 
                        label: 'ชาย', 
                        data: data1.map(d => d.male), 
                        backgroundColor: '#6366f1', // Indigo-500
                        borderRadius: 6,
                        barPercentage: 0.6,
                    },
                    { 
                        label: 'หญิง', 
                        data: data1.map(d => d.female), 
                        backgroundColor: '#ec4899', // Pink-500
                        borderRadius: 6,
                        barPercentage: 0.6,
                    }
                ]
            },
            options: {
                indexAxis: 'y',
                responsive: true,
                maintainAspectRatio: false,
                scales: { 
                    x: { stacked: true, grid: { display: false } }, 
                    y: { stacked: true, grid: { borderDash: [4, 4], color: '#f1f5f9' } } 
                },
                plugins: { 
                    legend: { position: 'bottom', labels: { usePointStyle: true, boxWidth: 8 } } 
                }
            }
        });

        const ctxPie = document.getElementById('pieChart').getContext('2d');
        new Chart(ctxPie, {
            type: 'doughnut',
            data: {
                labels: data1.map(d => d.center),
                datasets: [{
                    data: data1.map(d => d.sample),
                    backgroundColor: [
                        '#3b82f6', '#10b981', '#f59e0b', '#ef4444', '#8b5cf6', '#ec4899'
                    ],
                    borderWidth: 2,
                    borderColor: '#ffffff',
                    hoverOffset: 4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                cutout: '65%',
                plugins: { 
                    legend: { position: 'right', labels: { boxWidth: 12, padding: 15 } } 
                }
            }
        });

        lucide.createIcons();
    </script>
</body>
</html>
